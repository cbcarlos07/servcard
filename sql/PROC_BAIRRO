DELIMITER $$

DROP PROCEDURE IF EXISTS `PROC_ANO` $$
CREATE DEFINER=`root`@`localhost` PROCEDURE `PROC_ANO`(
CODIGO INT,
TEXTO VARCHAR(75),
ACAO    CHAR(1)
)
BEGIN
DECLARE TEXTO_ VARCHAR(75);
SET TEXTO_ = CONCAT('%',TEXTO,'%');
CASE
   WHEN ACAO = 'I'      THEN INSERT INTO `pais` VALUES (NULL, TEXTO);
   WHEN ACAO = 'A'       THEN  UPDATE `pais` SET `DS_PAIS` = TEXTO WHERE `CD_PAIS` = CODIGO;
   WHEN ACAO = 'E'       THEN  DELETE FROM `pais` WHERE `CD_PAIS` = CODIGO;
   WHEN ACAO = 'N'       THEN SELECT * FROM `pais` WHERE `DS_PAIS` LIKE TEXTO_;
   WHEN ACAO = 'C'       THEN SELECT * FROM `pais` WHERE `CD_PAIS` = CODIGO;
   WHEN ACAO = 'T'       THEN SELECT * FROM `pais` ORDER BY `DS_PAIS` DESC;

END CASE;
END $$

DELIMITER ;


CREATE OR REPLACE VIEW `V_BAIRRO` AS
 SELECT `B`.`CD_BAIRRO`
        ,`B`.`NM_BAIRRO`
        ,`B`.`CD_CIDADE`
        ,`C`.`NM_CIDADE`
        ,`B`.`CD_ZONA`
        ,`Z`.`DS_ZONA`
FROM `bairro` `B` 
JOIN `cidade` `C` ON `C`.`CD_CIDADE` = `B`.`CD_CIDADE`
JOIN `zona`   `Z` ON `Z`.`CD_ZONA` = `B`.`CD_ZONA`
